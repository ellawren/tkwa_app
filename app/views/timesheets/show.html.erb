<% content_for :page_header do %>
	<% provide :title, "#{parse_date_full(@timesheet.week, @timesheet.year)}" %>
	<div class="page-header">
        <h1><%= @user.name %>  &nbsp;<span class="light"><%= parse_date_full(@timesheet.week, @timesheet.year) %></span></h1>
    </div>		
<% end %>

<% content_for :tabnav do %>
	<%= render "tabnav_timesheets" %>
<% end %>

<!-- modal for phases -->
	<div class="modal hide fade phases" id="phaseModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  	<div class="modal-header">
	    	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
	    	<h3 id="myModalLabel">Phases</h3>
	  	</div>
	  	<div class="modal-body"></div>
	</div>
<!-- end modal -->

<%= form_for(@timesheet, :html => { :class => "#{'complete' unless @timesheet.open?}" }) do |f| %>

<div class="switch-box">
	<%= f.check_box(:complete, { data_toggle: "switch"  } )  %> 
</div>
	
<div class="box">
	<%= render 'shared/error_messages', :object => f.object %>

    <div class="table-main timesheets">

		<div class="table-head">
			<div class="cell project-name"><div class="timesheet-tab">Billable Time</div></div>
			<div class="cell phase"><br />Phase<a href="<%= modal_phases_path %>" data-target="#phaseModal" data-toggle="modal" class="inline-edit-link fui-eye"></a></div>
			<div class="cell task"><br />Task</div>
			<div class="cell date weekend <%= is_today?(1, @timesheet) %>"><%= date_label(1, @timesheet) %></div>
			<div class="cell date <%= is_today?(2, @timesheet) %>"><%= date_label(2, @timesheet) %></div>
			<div class="cell date <%= is_today?(3, @timesheet) %>"><%= date_label(3, @timesheet) %></div>
			<div class="cell date <%= is_today?(4, @timesheet) %>"><%= date_label(4, @timesheet) %></div>
			<div class="cell date <%= is_today?(5, @timesheet) %>"><%= date_label(5, @timesheet) %></div>
			<div class="cell date <%= is_today?(6, @timesheet) %>"><%= date_label(6, @timesheet) %></div>
			<div class="cell date weekend <%= is_today?(7, @timesheet) %>"><%= date_label(7, @timesheet) %></div>
			<div class="total"><br />Total</div>
		</div>

  		<div class="table-body">
			<!-- nested form for team-->
    		<%= f.fields_for :time_entries do |builder| %>
    			<%= render 'time_entry_fields', :f => builder %>
    		<% end %>
    		<!-- this is commented out because new lines are automatically added to the view -->
    		<% if @timesheet.open? %>
        		<%= link_to_add_fields "", f, :time_entries, "add fui-plus timesheets" %>
        	<% end %>
   			<!-- end team form -->
   		</div>	
           					
    </div> <!-- end billable timesheets table -->

    <div class="table-main timesheets non-billable">
		<div class="table-head">
			
			<div class="cell category"><div class="timesheet-tab">Non-Billable Time</div></div>
			<div class="cell nb-description">Description <span class="note">(optional)</span></div>
			
		</div>

  		<div class="table-body">

  			<% if @timesheet.holidays.count > 0 %>
  				<% @timesheet.holidays.each do |h| %>
  					<%= render 'holiday_fields', :f => h  %>
  				<% end %>
  			<% end %>

			<!-- nested form for team-->
    		<%= f.fields_for :non_billable_entries do |builder| %>
    			<%= render 'non_billable_entry_fields', :f => builder %>
    		<% end %>
    		<!-- this is commented out because new lines are automatically added to the view -->
    		<% if @timesheet.open? %>
        		<%= link_to_add_fields "", f, :non_billable_entries, "add fui-plus timesheets" %>
        	<% end %>
   			<!-- end team form -->
   		</div>	

    </div> <!-- end non-billable timesheets table -->
	
	<div class="summary">
		<div class="summary-label">Week Totals</div>
		<div class="span">

			<div class="sum <%= is_today?(1, @timesheet) %>"><%= precise(nonzero?(timesheet_sum(:day1))) %></div>
			<div class="sum <%= is_today?(2, @timesheet) %>"><%= precise(nonzero?(timesheet_sum(:day2))) %></div>
			<div class="sum <%= is_today?(3, @timesheet) %>"><%= precise(nonzero?(timesheet_sum(:day3))) %></div>
			<div class="sum <%= is_today?(4, @timesheet) %>"><%= precise(nonzero?(timesheet_sum(:day4))) %></div>
			<div class="sum <%= is_today?(5, @timesheet) %>"><%= precise(nonzero?(timesheet_sum(:day5))) %></div>
			<div class="sum <%= is_today?(6, @timesheet) %>"><%= precise(nonzero?(timesheet_sum(:day6))) %></div>
			<div class="sum <%= is_today?(7, @timesheet) %>"><%= precise(nonzero?(timesheet_sum(:day7))) %></div>
		</div>
	</div>

	<div class="timesheet-total"><%= precise(nonzero?(@timesheet.timesheet_total)) %></div>

	<div class="save-row">
        <%= f.submit "Save + Update Totals", class: "btn btn-primary save-btn" %>
        <%= f.submit "Reopen Timesheet", class: "btn reopen" %>
	</div>

</div>  <!-- end box-->


<% end %> <!-- end form -->


			    
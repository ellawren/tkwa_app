<% content_for :page_header do %>
	<% provide :title, "Projects" %>
    <div class="page-header">
        <h1>Projects Database</h1>
        <!--<ul class="controls">
            <li><a href="/projects/">reset</a></li>
            <li><a href="#">advanced search</a></li>
        </ul>-->
    </div>
<% end %>

<h2 class="first">Search Projects</h2>

<div class="description">Enter all or part of the project name. Choose an option from the menu at left to narrow your search. To show all projects within a category, just leave the name and number fields blank.</div>

<div class="gray-box">

	<%= search_form_for @q do |f| %>

		<div class="status-options">
	        <div><%= f.radio_button(:status_cont, "") %><label class="radio">All</label></div>
			<div><%= f.radio_button(:status_cont, "current") %><label class="radio">Current</label></div>
			<div><%= f.radio_button(:status_cont, "completed") %><label class="radio">Completed</label></div>
		</div>

		<%= f.text_field :name_cont, class: "search-name", placeholder: "Project Name" %>   
		<%= f.text_field :number_eq, class: "search-number", placeholder: "Number" %>    
		<%= f.submit "Search", class: "btn btn-primary search-btn" %>
			     
	<% end %>

</div>

<% if (params.has_key?(:q)) %>

	<% if @projects.count == 0 %>
        <h2>Search Results</h2>
		    <div class="search-results">
                No matches.<br><br><a href="/projects/" class="btn">Clear search and try again.</a><br><br>
                <div class="line"></div>
            </div>
        
	<% else %>

    <h2>Search Results (<%= @projects.count %>) <a class="reset" href="/projects">reset search</a></h2>

		<table class="table search-results">
            <thead>
                <tr>
                    <th>Number</th>
                    <th>Name</th>
                    <th>Delete?</th>
                </tr>
            </thead>
		    <tbody>
		        <% @projects.each do |param| %>
		            <%= render 'project', :f => param %>
		        <% end %>
		    </tbody>
		</table>
        <%= will_paginate @project %>
        <div class="line"></div>

	<% end %>

<% end %>

<div class="row icons three">

    <div class="tile-box">
        <%= link_to image_tag("bell.png", :alt => "new-project", :class => "round-icon"), new_project_path(:status => 'current') %>
        <%= link_to "Add A New Project", new_project_path(:status => 'current'), :class => "tile-label" %>
    </div>

    <div class="tile-box">
        <%= link_to image_tag("forecast.png", :alt => "forecast", :class => "round-icon"), projects_forecast_path %>
        <%= link_to "Project Forecast", projects_forecast_path, :class => "tile-label" %>
    </div>

    <div class="tile-box">
        <%= link_to image_tag("potential.png", :alt => "potential", :class => "round-icon"), "/potential_projects" %>
        <%= link_to "Potential Projects", "/potential_projects", :class => "tile-label" %>
    </div>

  </div> <!-- end tiles -->

<% if has_current_projects?(@user) %>
  <h2>My Current Projects</h2>
  	<ul class="tile-list">
        <% @user.employee_teams.current.each do |team| %>
        <li><%= link_to Project.find_by_id(team.project_id).name, info_project_path(Project.find_by_id(team.project_id)) %></li>
        <% end %>
     </ul>
<% end %>


